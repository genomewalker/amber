<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 420" width="1200" height="420">
<defs>
  <style>* { font-family: -apple-system, 'Helvetica Neue', Arial, sans-serif; }</style>
  <marker id="arr" viewBox="0 0 8 6" refX="7" refY="3" markerWidth="6" markerHeight="6" orient="auto">
    <path d="M0,0 L8,3 L0,6 Z" fill="#64748B"/>
  </marker>
  <marker id="arr-amber" viewBox="0 0 8 6" refX="7" refY="3" markerWidth="6" markerHeight="6" orient="auto">
    <path d="M0,0 L8,3 L0,6 Z" fill="#B45309"/>
  </marker>
</defs>

<rect width="1200" height="420" fill="#FAFAF8"/>

<!-- Title -->
<text x="600" y="28" text-anchor="middle" font-size="18" font-weight="700" fill="#0F172A" letter-spacing="2">AMBER</text>
<text x="600" y="46" text-anchor="middle" font-size="10" fill="#64748B">Ancient Metagenomic Binning with aDNA-aware Encoder and Refinement</text>

<!-- ══ ROW 1: INPUTS ══ -->
<rect x="20" y="70" width="140" height="70" rx="4" fill="#FFFFFF" stroke="#CBD5E1" stroke-width="1.5"/>
<text x="90" y="98" text-anchor="middle" font-size="11" font-weight="600" fill="#334155">Contigs</text>
<text x="90" y="114" text-anchor="middle" font-size="9" fill="#64748B">FASTA</text>
<text x="90" y="128" text-anchor="middle" font-size="8" fill="#94A3B8">TNF · length</text>

<rect x="180" y="70" width="140" height="70" rx="4" fill="#FFFFFF" stroke="#CBD5E1" stroke-width="1.5"/>
<text x="250" y="98" text-anchor="middle" font-size="11" font-weight="600" fill="#334155">Alignments</text>
<text x="250" y="114" text-anchor="middle" font-size="9" fill="#64748B">BAM</text>
<text x="250" y="128" text-anchor="middle" font-size="8" fill="#94A3B8">coverage · damage</text>

<rect x="340" y="70" width="140" height="70" rx="4" fill="#FFFBEF" stroke="#C27B0A" stroke-width="1.5"/>
<text x="410" y="98" text-anchor="middle" font-size="11" font-weight="600" fill="#78350F">SCG Markers</text>
<text x="410" y="114" text-anchor="middle" font-size="9" fill="#92400E">HMM profiles</text>
<text x="410" y="128" text-anchor="middle" font-size="8" fill="#B45309">206 markers</text>

<!-- Arrows from inputs -->
<line x1="90" y1="140" x2="90" y2="170" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>
<line x1="250" y1="140" x2="250" y2="170" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>
<line x1="410" y1="140" x2="410" y2="170" stroke="#B45309" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#arr-amber)"/>

<!-- ══ ROW 2: FEATURES ══ -->
<rect x="20" y="175" width="300" height="55" rx="4" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
<text x="170" y="198" text-anchor="middle" font-size="10" font-weight="600" fill="#334155">Feature Extraction</text>
<text x="170" y="214" text-anchor="middle" font-size="9" fill="#64748B">138d encoder input (TNF + coverage) · 29d bypass (aDNA + CGR)</text>

<rect x="340" y="175" width="140" height="55" rx="4" fill="#FFFBEF" stroke="#FCD34D" stroke-width="1"/>
<text x="410" y="198" text-anchor="middle" font-size="10" font-weight="600" fill="#78350F">SCG Labels</text>
<text x="410" y="214" text-anchor="middle" font-size="9" fill="#92400E">positive pairs · seeds</text>

<!-- Arrow to encoder -->
<line x1="170" y1="230" x2="170" y2="260" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>
<path d="M410,230 L410,245 Q410,255 400,255 L180,255 Q170,255 170,260" fill="none" stroke="#B45309" stroke-width="1.5" stroke-dasharray="4,3"/>

<!-- ══ ROW 3: ENCODER ══ -->
<rect x="20" y="265" width="460" height="60" rx="4" fill="#FEF3C7" stroke="#C27B0A" stroke-width="1.5"/>
<text x="250" y="290" text-anchor="middle" font-size="11" font-weight="700" fill="#78350F">SCG-supervised InfoNCE Encoder</text>
<text x="250" y="308" text-anchor="middle" font-size="9" fill="#92400E">MLP 138→512→256→128 · 6 augmented views · 3 encoder seeds</text>

<!-- Arrow to concat -->
<line x1="250" y1="325" x2="250" y2="345" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>

<!-- ══ ROW 4: CONCAT BAR ══ -->
<rect x="20" y="350" width="460" height="32" rx="4" fill="#1E293B"/>
<text x="250" y="371" text-anchor="middle" font-size="10" font-weight="600" fill="#FFFFFF">157-dim feature space  (128 encoder + 20 aDNA + 9 CGR)</text>

<!-- Arrow to graph -->
<line x1="480" y1="366" x2="510" y2="366" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>

<!-- ══ COLUMN 2: GRAPH + LEIDEN ══ -->
<rect x="520" y="70" width="220" height="95" rx="4" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
<text x="630" y="95" text-anchor="middle" font-size="11" font-weight="600" fill="#334155">k-NN Graph</text>
<text x="630" y="115" text-anchor="middle" font-size="9" fill="#64748B">HNSW · k=10 · cosine</text>
<text x="630" y="133" text-anchor="middle" font-size="9" fill="#92400E">SCG-guided edge weights</text>
<text x="630" y="151" text-anchor="middle" font-size="8" fill="#B45309">complement bonus · shared penalty</text>

<line x1="630" y1="165" x2="630" y2="185" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>

<rect x="520" y="190" width="220" height="115" rx="4" fill="#FFFBEF" stroke="#C27B0A" stroke-width="1.5"/>
<text x="630" y="213" text-anchor="middle" font-size="11" font-weight="700" fill="#78350F">Quality Leiden</text>
<text x="630" y="233" text-anchor="middle" font-size="9" fill="#334155">Phase 1: CPM clustering</text>
<text x="630" y="249" text-anchor="middle" font-size="9" fill="#334155">Phase 2: Contamination split</text>
<text x="630" y="265" text-anchor="middle" font-size="9" fill="#334155">Phase 3: SCG rescue</text>
<text x="630" y="285" text-anchor="middle" font-size="8" fill="#64748B">75 parallel runs (3 enc × 25 Leiden seeds)</text>

<line x1="630" y1="305" x2="630" y2="335" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>

<rect x="520" y="340" width="220" height="55" rx="4" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
<text x="630" y="363" text-anchor="middle" font-size="10" font-weight="600" fill="#334155">amber resolve</text>
<text x="630" y="381" text-anchor="middle" font-size="9" fill="#64748B">co-binning consensus · N runs</text>

<!-- Arrow to output -->
<line x1="740" y1="366" x2="770" y2="366" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>

<!-- ══ COLUMN 3: OUTPUT ══ -->
<rect x="780" y="70" width="400" height="325" rx="4" fill="#FFFFFF" stroke="#CBD5E1" stroke-width="1.5"/>
<text x="980" y="100" text-anchor="middle" font-size="13" font-weight="700" fill="#334155">Output</text>

<rect x="800" y="120" width="360" height="50" rx="3" fill="#DCFCE7" stroke="#86EFAC" stroke-width="1"/>
<text x="980" y="143" text-anchor="middle" font-size="11" font-weight="600" fill="#166534">HQ Bins</text>
<text x="980" y="160" text-anchor="middle" font-size="9" fill="#22C55E">≥90% completeness · &lt;5% contamination</text>

<rect x="800" y="180" width="360" height="40" rx="3" fill="#FEF9C3" stroke="#FDE047" stroke-width="1"/>
<text x="980" y="200" text-anchor="middle" font-size="10" font-weight="600" fill="#854D0E">MQ Bins</text>
<text x="980" y="214" text-anchor="middle" font-size="9" fill="#CA8A04">≥50% completeness · &lt;10% contamination</text>

<rect x="800" y="235" width="175" height="70" rx="3" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
<text x="887" y="260" text-anchor="middle" font-size="10" font-weight="600" fill="#334155">Per-bin stats</text>
<text x="887" y="278" text-anchor="middle" font-size="8" fill="#64748B">SCG profile</text>
<text x="887" y="290" text-anchor="middle" font-size="8" fill="#64748B">completeness · contamination</text>

<rect x="985" y="235" width="175" height="70" rx="3" fill="#FFFBEF" stroke="#FCD34D" stroke-width="1"/>
<text x="1072" y="260" text-anchor="middle" font-size="10" font-weight="600" fill="#78350F">Damage profile</text>
<text x="1072" y="278" text-anchor="middle" font-size="8" fill="#92400E">C→T (5′) · G→A (3′)</text>
<text x="1072" y="290" text-anchor="middle" font-size="8" fill="#92400E">decay λ · fragment stats</text>

<rect x="800" y="320" width="360" height="55" rx="3" fill="#F8FAFC" stroke="#E2E8F0" stroke-width="1"/>
<text x="980" y="343" text-anchor="middle" font-size="10" font-weight="600" fill="#334155">amber deconvolve</text>
<text x="980" y="360" text-anchor="middle" font-size="9" fill="#64748B">EM separation of ancient/modern populations</text>

</svg>
