<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="500" viewBox="0 0 1000 500">
  <defs>
    <radialGradient id="bgGrad" cx="35%" cy="15%" r="90%">
      <stop offset="0%" stop-color="#FFFFFF"/>
      <stop offset="65%" stop-color="#FBFBFA"/>
      <stop offset="100%" stop-color="#F7F8F7"/>
    </radialGradient>
    <filter id="softShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="4" flood-color="#2B2B2B" flood-opacity="0.10"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect fill="url(#bgGrad)" x="0" y="0" width="1000" height="500"/>

  <!-- Spine -->
  <line stroke="#B9C0C7" stroke-width="1" stroke-linecap="round" x1="500" y1="105" x2="500" y2="452"/>

  <!-- Spine nodes -->
  <circle fill="#F3F5F7" stroke="#B9C0C7" stroke-width="1" cx="500" cy="120" r="5"/>
  <circle fill="#F3F5F7" stroke="#B9C0C7" stroke-width="1" cx="500" cy="180" r="5"/>
  <circle fill="#F3F5F7" stroke="#B9C0C7" stroke-width="1" cx="500" cy="255" r="5"/>
  <circle fill="#F3F5F7" stroke="#B9C0C7" stroke-width="1" cx="500" cy="320" r="5"/>
  <circle fill="#F3F5F7" stroke="#B9C0C7" stroke-width="1" cx="500" cy="395" r="5"/>
  <circle fill="#F3F5F7" stroke="#B9C0C7" stroke-width="1" cx="500" cy="445" r="5"/>

  <!-- Inputs -->
  <g transform="translate(305,70)">
    <rect fill="#FFFFFF" stroke="#E3E7EB" stroke-width="1" x="-70" y="-18" rx="18" ry="18" width="140" height="36"/>
    <g transform="translate(-48,0)">
      <line x1="0" y1="-6" x2="22" y2="-6" stroke="#2B2B2B" stroke-width="1" opacity="0.55" stroke-linecap="round"/>
      <line x1="0" y1="0" x2="22" y2="0" stroke="#2B2B2B" stroke-width="1" opacity="0.55" stroke-linecap="round"/>
      <line x1="0" y1="6" x2="22" y2="6" stroke="#2B2B2B" stroke-width="1" opacity="0.55" stroke-linecap="round"/>
      <circle fill="#B9C0C7" opacity="0.8" cx="26" cy="-6" r="1.6"/>
      <circle fill="#B9C0C7" opacity="0.8" cx="26" cy="0" r="1.6"/>
      <circle fill="#B9C0C7" opacity="0.8" cx="26" cy="6" r="1.6"/>
    </g>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.90" x="6" y="4">Contigs</text>
  </g>

  <g transform="translate(500,70)">
    <rect fill="#FFFFFF" stroke="#E3E7EB" stroke-width="1" x="-58" y="-18" rx="18" ry="18" width="116" height="36"/>
    <g transform="translate(-36,0)" opacity="0.62">
      <ellipse cx="10" cy="-6" rx="9" ry="4" fill="#2B2B2B" opacity="0.20"/>
      <rect x="1" y="-6" width="18" height="14" fill="#2B2B2B" opacity="0.14"/>
      <ellipse cx="10" cy="8" rx="9" ry="4" fill="#2B2B2B" opacity="0.18"/>
      <ellipse cx="10" cy="-6" rx="9" ry="4" fill="none" stroke="#2B2B2B" stroke-width="1" opacity="0.55"/>
      <line x1="1" y1="-6" x2="1" y2="8" stroke="#2B2B2B" stroke-width="1" opacity="0.45"/>
      <line x1="19" y1="-6" x2="19" y2="8" stroke="#2B2B2B" stroke-width="1" opacity="0.45"/>
      <ellipse cx="10" cy="8" rx="9" ry="4" fill="none" stroke="#2B2B2B" stroke-width="1" opacity="0.45"/>
    </g>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.90" x="0" y="4">BAM</text>
  </g>

  <g transform="translate(695,70)">
    <rect fill="#FFFFFF" stroke="#E3E7EB" stroke-width="1" x="-76" y="-18" rx="18" ry="18" width="152" height="36"/>
    <g transform="translate(-54,0)" opacity="0.62">
      <path d="M6,-10 C14,-10 14,10 6,10 C-2,10 -2,-10 6,-10Z" fill="#2B2B2B" opacity="0.12"/>
      <path d="M6,-10 C14,-10 14,10 6,10" fill="none" stroke="#2B2B2B" stroke-width="1" opacity="0.55"/>
      <path d="M6,-10 C-2,-10 -2,10 6,10" fill="none" stroke="#2B2B2B" stroke-width="1" opacity="0.35"/>
      <line x1="14" y1="-6" x2="22" y2="-6" stroke="#2B2B2B" stroke-width="1" opacity="0.45" stroke-linecap="round"/>
      <line x1="14" y1="0" x2="22" y2="0" stroke="#2B2B2B" stroke-width="1" opacity="0.45" stroke-linecap="round"/>
      <line x1="14" y1="6" x2="22" y2="6" stroke="#2B2B2B" stroke-width="1" opacity="0.45" stroke-linecap="round"/>
    </g>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.90" x="4" y="4">SCG</text>
  </g>

  <!-- Input connectors -->
  <path stroke="#B9C0C7" stroke-width="1" stroke-linecap="round" fill="none" d="M305,88 C305,112 420,112 500,120"/>
  <path stroke="#B9C0C7" stroke-width="1" stroke-linecap="round" fill="none" d="M500,88 C500,104 500,108 500,120"/>
  <path stroke="#B9C0C7" stroke-width="1" stroke-linecap="round" fill="none" d="M695,88 C695,112 580,112 500,120"/>

  <!-- Features island -->
  <g transform="translate(500,180)">
    <rect fill="#EEF1F4" stroke="#E3E7EB" stroke-width="1" filter="url(#softShadow)" x="-220" y="-36" rx="22" ry="22" width="440" height="72"/>
    <text font-family="Helvetica,Arial,sans-serif" font-size="16" font-weight="600" fill="#2B2B2B" x="-190" y="-6">Feature extraction</text>

    <g transform="translate(-190,18)">
      <rect fill="#FFFFFF" stroke="#E3E7EB" stroke-width="1" x="0" y="-14" rx="14" ry="14" width="92" height="28"/>
      <text font-family="Menlo,Consolas,monospace" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.78" x="14" y="5">138d</text>
      <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.70" x="50" y="5">enc</text>
    </g>

    <g transform="translate(-85,18)">
      <rect fill="#FFFFFF" stroke="#E46A5D" stroke-width="1" x="0" y="-14" rx="14" ry="14" width="98" height="28"/>
      <text font-family="Menlo,Consolas,monospace" font-size="11" font-weight="600" fill="#E46A5D" x="14" y="5">20d</text>
      <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="600" fill="#E46A5D" x="50" y="5">aDNA</text>
    </g>

    <g transform="translate(25,18)">
      <rect fill="#FFFFFF" stroke="#E3E7EB" stroke-width="1" x="0" y="-14" rx="14" ry="14" width="86" height="28"/>
      <text font-family="Menlo,Consolas,monospace" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.78" x="14" y="5">9d</text>
      <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.70" x="42" y="5">CGR</text>
    </g>

    <text font-family="Helvetica,Arial,sans-serif" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.72" x="125" y="22">bypass</text>
  </g>

  <!-- Connector: inputs -> features -->
  <path stroke="#B9C0C7" stroke-width="1" stroke-linecap="round" fill="none" d="M500,120 C500,142 500,156 500,144"/>

  <!-- Encoder island -->
  <g transform="translate(500,255)">
    <rect fill="#EEF1F4" stroke="#E3E7EB" stroke-width="1" filter="url(#softShadow)" x="-200" y="-38" rx="22" ry="22" width="400" height="76"/>
    <text font-family="Helvetica,Arial,sans-serif" font-size="16" font-weight="600" fill="#2B2B2B" x="-170" y="-10">Encoder</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.72" x="-170" y="8">Damage-aware SCG-supervised</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.90" x="-170" y="28">InfoNCE</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.55" x="-108" y="28">·</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.90" x="-94" y="28">MLP</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.55" x="-54" y="28">·</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.90" x="-40" y="28">6 views</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.55" x="24" y="28">→</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.78" x="48" y="28">128d</text>

    <circle fill="#E46A5D" opacity="0.65" cx="-118" cy="26" r="2.4"/>
    <circle fill="none" stroke="#E46A5D" stroke-width="1" opacity="0.18" cx="-118" cy="26" r="6"/>
  </g>

  <!-- Connector: features -> encoder -->
  <path stroke="#B9C0C7" stroke-width="1" stroke-linecap="round" fill="none" d="M500,216 C500,228 500,236 500,217"/>

  <!-- aDNA subtle feed -->
  <path stroke="#E46A5D" stroke-width="1" stroke-linecap="round" fill="none" opacity="0.55" d="M415,198 C410,220 396,246 382,281"/>

  <!-- CGR bypass -->
  <path stroke="#CDD3D9" stroke-width="1" stroke-linecap="round" fill="none" opacity="0.85" d="M548,198 C635,215 665,262 630,305 C608,332 560,336 520,332"/>

  <!-- Concat island -->
  <g transform="translate(500,320)">
    <rect fill="#EEF1F4" stroke="#E3E7EB" stroke-width="1" filter="url(#softShadow)" x="-165" y="-30" rx="22" ry="22" width="330" height="60"/>
    <text font-family="Helvetica,Arial,sans-serif" font-size="16" font-weight="600" fill="#2B2B2B" x="-135" y="-4">Concat</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="16" font-weight="600" fill="#2B2B2B" opacity="0.78" x="-60" y="-4">157d</text>

    <text font-family="Menlo,Consolas,monospace" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.78" x="-135" y="18">128</text>
    <text font-family="Menlo,Consolas,monospace" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.55" x="-96" y="18">+</text>
    <text font-family="Menlo,Consolas,monospace" font-size="11" font-weight="600" fill="#E46A5D" x="-78" y="18">20</text>
    <circle fill="#E46A5D" opacity="0.9" cx="-60" cy="14" r="3.2"/>
    <text font-family="Menlo,Consolas,monospace" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.55" x="-48" y="18">+</text>
    <text font-family="Menlo,Consolas,monospace" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.78" x="-30" y="18">9</text>
  </g>

  <!-- Connector: encoder -> concat -->
  <path stroke="#B9C0C7" stroke-width="1" stroke-linecap="round" fill="none" d="M500,293 C500,300 500,306 500,290"/>

  <!-- Ensemble island -->
  <g transform="translate(500,395)">
    <rect fill="#EEF1F4" stroke="#E3E7EB" stroke-width="1" filter="url(#softShadow)" x="-240" y="-38" rx="22" ry="22" width="480" height="76"/>

    <!-- dot matrix: 3 x 25 = 75 -->
    <g transform="translate(-206,-16)">
      <g fill="#B9C0C7" opacity="0.8">
        <circle cx="0" cy="0" r="1.6"/><circle cx="7" cy="0" r="1.6"/><circle cx="14" cy="0" r="1.6"/><circle cx="21" cy="0" r="1.6"/><circle cx="28" cy="0" r="1.6"/><circle cx="35" cy="0" r="1.6"/><circle cx="42" cy="0" r="1.6"/><circle cx="49" cy="0" r="1.6"/><circle cx="56" cy="0" r="1.6"/><circle cx="63" cy="0" r="1.6"/><circle cx="70" cy="0" r="1.6"/><circle cx="77" cy="0" r="1.6"/><circle cx="84" cy="0" r="1.6"/><circle cx="91" cy="0" r="1.6"/><circle cx="98" cy="0" r="1.6"/><circle cx="105" cy="0" r="1.6"/><circle cx="112" cy="0" r="1.6"/><circle cx="119" cy="0" r="1.6"/><circle cx="126" cy="0" r="1.6"/><circle cx="133" cy="0" r="1.6"/><circle cx="140" cy="0" r="1.6"/><circle cx="147" cy="0" r="1.6"/><circle cx="154" cy="0" r="1.6"/><circle cx="161" cy="0" r="1.6"/><circle cx="168" cy="0" r="1.6"/>
        <circle cx="0" cy="10" r="1.6"/><circle cx="7" cy="10" r="1.6"/><circle cx="14" cy="10" r="1.6"/><circle cx="21" cy="10" r="1.6"/><circle cx="28" cy="10" r="1.6"/><circle cx="35" cy="10" r="1.6"/><circle cx="42" cy="10" r="1.6"/><circle cx="49" cy="10" r="1.6"/><circle cx="56" cy="10" r="1.6"/><circle cx="63" cy="10" r="1.6"/><circle cx="70" cy="10" r="1.6"/><circle cx="77" cy="10" r="1.6"/><circle cx="84" cy="10" r="1.6"/><circle cx="91" cy="10" r="1.6"/><circle cx="98" cy="10" r="1.6"/><circle cx="105" cy="10" r="1.6"/><circle cx="112" cy="10" r="1.6"/><circle cx="119" cy="10" r="1.6"/><circle cx="126" cy="10" r="1.6"/><circle cx="133" cy="10" r="1.6"/><circle cx="140" cy="10" r="1.6"/><circle cx="147" cy="10" r="1.6"/><circle cx="154" cy="10" r="1.6"/><circle cx="161" cy="10" r="1.6"/><circle cx="168" cy="10" r="1.6"/>
        <circle cx="0" cy="20" r="1.6"/><circle cx="7" cy="20" r="1.6"/><circle cx="14" cy="20" r="1.6"/><circle cx="21" cy="20" r="1.6"/><circle cx="28" cy="20" r="1.6"/><circle cx="35" cy="20" r="1.6"/><circle cx="42" cy="20" r="1.6"/><circle cx="49" cy="20" r="1.6"/><circle cx="56" cy="20" r="1.6"/><circle cx="63" cy="20" r="1.6"/><circle cx="70" cy="20" r="1.6"/><circle cx="77" cy="20" r="1.6"/><circle cx="84" cy="20" r="1.6"/><circle cx="91" cy="20" r="1.6"/><circle cx="98" cy="20" r="1.6"/><circle cx="105" cy="20" r="1.6"/><circle cx="112" cy="20" r="1.6"/><circle cx="119" cy="20" r="1.6"/><circle cx="126" cy="20" r="1.6"/><circle cx="133" cy="20" r="1.6"/><circle cx="140" cy="20" r="1.6"/><circle cx="147" cy="20" r="1.6"/><circle cx="154" cy="20" r="1.6"/><circle cx="161" cy="20" r="1.6"/><circle cx="168" cy="20" r="1.6"/>
      </g>
      <text font-family="Menlo,Consolas,monospace" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.70" x="186" y="14">×75</text>
    </g>

    <text font-family="Helvetica,Arial,sans-serif" font-size="16" font-weight="600" fill="#2B2B2B" x="-10" y="-6">Parallel runs</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="12" font-weight="500" fill="#2B2B2B" opacity="0.90" x="-10" y="18">k-NN + Quality Leiden</text>
    <text font-family="Helvetica,Arial,sans-serif" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.72" x="-10" y="34">3 encoder × 25 Leiden seeds</text>
  </g>

  <!-- Connector: concat -> ensemble -->
  <path stroke="#B9C0C7" stroke-width="1" stroke-linecap="round" fill="none" d="M500,350 C500,362 500,370 500,357"/>

  <!-- Resolve + Final bins -->
  <g transform="translate(500,445)">
    <rect fill="#EEF1F4" stroke="#E3E7EB" stroke-width="1" filter="url(#softShadow)" x="-210" y="-28" rx="22" ry="22" width="420" height="56"/>
    <text font-family="Helvetica,Arial,sans-serif" font-size="16" font-weight="600" fill="#2B2B2B" x="-180" y="6">Co-binning consensus</text>

    <g transform="translate(98,-6)">
      <g transform="translate(0,0)">
        <rect x="0" y="-10" width="22" height="26" rx="4" ry="4" fill="#FFFFFF" stroke="#E3E7EB" stroke-width="1"/>
        <rect x="4" y="-6" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.18"/>
        <rect x="4" y="0" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.14"/>
        <rect x="4" y="6" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.12"/>
      </g>
      <g transform="translate(28,0)">
        <rect x="0" y="-10" width="22" height="26" rx="4" ry="4" fill="#FFFFFF" stroke="#E3E7EB" stroke-width="1"/>
        <rect x="4" y="-6" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.18"/>
        <rect x="4" y="0" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.14"/>
        <rect x="4" y="6" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.12"/>
      </g>
      <g transform="translate(56,0)">
        <rect x="0" y="-10" width="22" height="26" rx="4" ry="4" fill="#FFFFFF" stroke="#E3E7EB" stroke-width="1"/>
        <rect x="4" y="-6" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.18"/>
        <rect x="4" y="0" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.14"/>
        <rect x="4" y="6" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.12"/>
      </g>
      <g transform="translate(84,0)">
        <rect x="0" y="-10" width="22" height="26" rx="4" ry="4" fill="#FFFFFF" stroke="#E3E7EB" stroke-width="1"/>
        <rect x="4" y="-6" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.18"/>
        <rect x="4" y="0" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.14"/>
        <rect x="4" y="6" width="14" height="3" rx="1.5" fill="#2B2B2B" opacity="0.12"/>
      </g>
      <text font-family="Helvetica,Arial,sans-serif" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.72" x="10" y="30">bins</text>
    </g>
  </g>

  <!-- Connector: ensemble -> resolve -->
  <path stroke="#B9C0C7" stroke-width="1" stroke-linecap="round" fill="none" d="M500,433 C500,440 500,448 500,417"/>

  <!-- Caption -->
  <text font-family="Helvetica,Arial,sans-serif" font-size="11" font-weight="500" fill="#2B2B2B" opacity="0.45" x="32" y="486">AMBER: damage-aware representation + consensus co-binning</text>
</svg>
