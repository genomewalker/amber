<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 420" width="1000" height="420">
<defs>
  <marker id="arr" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="5" markerHeight="5" orient="auto">
    <path d="M0,0 L10,5 L0,10 Z" fill="#64748B"/>
  </marker>
  <linearGradient id="amber" x1="0%" y1="0%" x2="0%" y2="100%">
    <stop offset="0%" style="stop-color:#FEF3C7"/>
    <stop offset="100%" style="stop-color:#FDE68A"/>
  </linearGradient>
</defs>

<rect width="1000" height="420" fill="#FFFFFF"/>

<!-- TITLE -->
<text x="500" y="26" text-anchor="middle" font-size="15" font-weight="700" fill="#1E293B" font-family="Helvetica Neue, Arial, sans-serif" letter-spacing="3">AMBER</text>
<text x="500" y="42" text-anchor="middle" font-size="9" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">Ancient Metagenomic BinnER</text>

<!-- ══════════════════════════════════════════════════════════════════════════ -->
<!-- COL 1: INPUTS (x=20, w=120) -->
<!-- ══════════════════════════════════════════════════════════════════════════ -->
<text x="80" y="66" text-anchor="middle" font-size="8" font-weight="600" fill="#94A3B8" font-family="Helvetica Neue, Arial, sans-serif" letter-spacing="1">INPUTS</text>

<rect x="20" y="76" width="120" height="40" rx="3" fill="#F8FAFC" stroke="#CBD5E1" stroke-width="1"/>
<text x="80" y="96" text-anchor="middle" font-size="9" font-weight="600" fill="#1E293B" font-family="Helvetica Neue, Arial, sans-serif">Contigs</text>
<text x="80" y="108" text-anchor="middle" font-size="7" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">FASTA</text>

<rect x="20" y="124" width="120" height="40" rx="3" fill="#F8FAFC" stroke="#CBD5E1" stroke-width="1"/>
<text x="80" y="144" text-anchor="middle" font-size="9" font-weight="600" fill="#1E293B" font-family="Helvetica Neue, Arial, sans-serif">Alignments</text>
<text x="80" y="156" text-anchor="middle" font-size="7" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">BAM</text>

<rect x="20" y="172" width="120" height="40" rx="3" fill="url(#amber)" stroke="#D97706" stroke-width="1"/>
<text x="80" y="192" text-anchor="middle" font-size="9" font-weight="600" fill="#92400E" font-family="Helvetica Neue, Arial, sans-serif">SCG Markers</text>
<text x="80" y="204" text-anchor="middle" font-size="7" fill="#B45309" font-family="Helvetica Neue, Arial, sans-serif">206 HMM</text>

<line x1="140" y1="145" x2="162" y2="145" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>

<!-- ══════════════════════════════════════════════════════════════════════════ -->
<!-- COL 2: FEATURES (x=170, w=130) -->
<!-- ══════════════════════════════════════════════════════════════════════════ -->
<text x="235" y="66" text-anchor="middle" font-size="8" font-weight="600" fill="#94A3B8" font-family="Helvetica Neue, Arial, sans-serif" letter-spacing="1">FEATURES</text>

<rect x="170" y="76" width="130" height="52" rx="3" fill="#F8FAFC" stroke="#CBD5E1" stroke-width="1"/>
<text x="235" y="94" text-anchor="middle" font-size="9" font-weight="600" fill="#1E293B" font-family="Helvetica Neue, Arial, sans-serif">Encoder Input</text>
<text x="235" y="108" text-anchor="middle" font-size="7" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">TNF (136d) + cov (2d)</text>
<text x="235" y="120" text-anchor="middle" font-size="9" font-weight="700" fill="#334155" font-family="Helvetica Neue, Arial, sans-serif">138 d</text>

<rect x="170" y="136" width="130" height="56" rx="3" fill="url(#amber)" stroke="#D97706" stroke-width="1"/>
<text x="235" y="154" text-anchor="middle" font-size="9" font-weight="600" fill="#92400E" font-family="Helvetica Neue, Arial, sans-serif">aDNA Damage (20d)</text>
<text x="235" y="170" text-anchor="middle" font-size="7" fill="#78350F" font-family="Helvetica Neue, Arial, sans-serif">→ InfoNCE weights</text>
<text x="235" y="184" text-anchor="middle" font-size="7" fill="#78350F" font-family="Helvetica Neue, Arial, sans-serif">→ concat to embedding</text>

<rect x="170" y="200" width="130" height="40" rx="3" fill="#F8FAFC" stroke="#CBD5E1" stroke-width="1"/>
<text x="235" y="218" text-anchor="middle" font-size="9" font-weight="600" fill="#1E293B" font-family="Helvetica Neue, Arial, sans-serif">CGR (9d)</text>
<text x="235" y="232" text-anchor="middle" font-size="7" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">bypass → concat only</text>

<line x1="300" y1="145" x2="322" y2="145" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>

<!-- ══════════════════════════════════════════════════════════════════════════ -->
<!-- COL 3: ENCODER (x=330, w=150) -->
<!-- ══════════════════════════════════════════════════════════════════════════ -->
<text x="405" y="66" text-anchor="middle" font-size="8" font-weight="600" fill="#94A3B8" font-family="Helvetica Neue, Arial, sans-serif" letter-spacing="1">ENCODER</text>

<rect x="330" y="76" width="150" height="164" rx="3" fill="url(#amber)" stroke="#D97706" stroke-width="1.5"/>

<text x="405" y="96" text-anchor="middle" font-size="9" font-weight="700" fill="#78350F" font-family="Helvetica Neue, Arial, sans-serif">Damage-aware</text>
<text x="405" y="110" text-anchor="middle" font-size="9" font-weight="700" fill="#78350F" font-family="Helvetica Neue, Arial, sans-serif">SCG-supervised InfoNCE</text>

<rect x="342" y="120" width="126" height="18" rx="2" fill="#FFFFFF" stroke="#E5E7EB" stroke-width="1"/>
<text x="405" y="133" text-anchor="middle" font-size="7" fill="#374151" font-family="Helvetica Neue, Arial, sans-serif">MLP: 138→512→256→128</text>

<rect x="342" y="144" width="126" height="18" rx="2" fill="#FFFFFF" stroke="#E5E7EB" stroke-width="1"/>
<text x="405" y="157" text-anchor="middle" font-size="7" fill="#374151" font-family="Helvetica Neue, Arial, sans-serif">6 augmented views</text>

<rect x="342" y="168" width="126" height="18" rx="2" fill="#FFFFFF" stroke="#E5E7EB" stroke-width="1"/>
<text x="405" y="181" text-anchor="middle" font-size="7" fill="#374151" font-family="Helvetica Neue, Arial, sans-serif">w_ij from aDNA damage</text>

<text x="405" y="206" text-anchor="middle" font-size="8" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">128d + 20d aDNA + 9d CGR</text>
<text x="405" y="222" text-anchor="middle" font-size="10" font-weight="700" fill="#92400E" font-family="Helvetica Neue, Arial, sans-serif">= 157 d</text>

<!-- ══════════════════════════════════════════════════════════════════════════ -->
<!-- 3 PARALLEL RUNS BOX -->
<!-- ══════════════════════════════════════════════════════════════════════════ -->
<rect x="330" y="256" width="480" height="122" rx="4" fill="#F1F5F9" stroke="#94A3B8" stroke-width="1" stroke-dasharray="4,2"/>
<text x="570" y="274" text-anchor="middle" font-size="9" font-weight="700" fill="#475569" font-family="Helvetica Neue, Arial, sans-serif">3 ENCODER RESTARTS × 25 LEIDEN SEEDS  =  75 PARALLEL RUNS</text>

<!-- Run 1 -->
<rect x="345" y="288" width="145" height="76" rx="3" fill="#FFFFFF" stroke="#CBD5E1" stroke-width="1"/>
<text x="417" y="306" text-anchor="middle" font-size="8" font-weight="600" fill="#334155" font-family="Helvetica Neue, Arial, sans-serif">Run 1</text>
<text x="417" y="322" text-anchor="middle" font-size="7" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">k-NN graph</text>
<text x="417" y="336" text-anchor="middle" font-size="7" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">Quality Leiden (3 phases)</text>
<text x="417" y="356" text-anchor="middle" font-size="7" fill="#94A3B8" font-family="Helvetica Neue, Arial, sans-serif">→ bins + .abin</text>

<!-- Run 2 -->
<rect x="500" y="288" width="145" height="76" rx="3" fill="#FFFFFF" stroke="#CBD5E1" stroke-width="1"/>
<text x="572" y="306" text-anchor="middle" font-size="8" font-weight="600" fill="#334155" font-family="Helvetica Neue, Arial, sans-serif">Run 2</text>
<text x="572" y="322" text-anchor="middle" font-size="7" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">k-NN graph</text>
<text x="572" y="336" text-anchor="middle" font-size="7" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">Quality Leiden (3 phases)</text>
<text x="572" y="356" text-anchor="middle" font-size="7" fill="#94A3B8" font-family="Helvetica Neue, Arial, sans-serif">→ bins + .abin</text>

<!-- Run 3 -->
<rect x="655" y="288" width="145" height="76" rx="3" fill="#FFFFFF" stroke="#CBD5E1" stroke-width="1"/>
<text x="727" y="306" text-anchor="middle" font-size="8" font-weight="600" fill="#334155" font-family="Helvetica Neue, Arial, sans-serif">Run 3</text>
<text x="727" y="322" text-anchor="middle" font-size="7" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">k-NN graph</text>
<text x="727" y="336" text-anchor="middle" font-size="7" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">Quality Leiden (3 phases)</text>
<text x="727" y="356" text-anchor="middle" font-size="7" fill="#94A3B8" font-family="Helvetica Neue, Arial, sans-serif">→ bins + .abin</text>

<!-- Arrow from encoder to parallel box -->
<line x1="405" y1="240" x2="405" y2="254" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>

<!-- ══════════════════════════════════════════════════════════════════════════ -->
<!-- RESOLVE -->
<!-- ══════════════════════════════════════════════════════════════════════════ -->
<line x1="810" y1="326" x2="832" y2="326" stroke="#64748B" stroke-width="1.5" marker-end="url(#arr)"/>

<rect x="840" y="288" width="140" height="76" rx="3" fill="url(#amber)" stroke="#D97706" stroke-width="1.5"/>
<text x="910" y="310" text-anchor="middle" font-size="10" font-weight="700" fill="#78350F" font-family="Helvetica Neue, Arial, sans-serif">amber resolve</text>
<text x="910" y="328" text-anchor="middle" font-size="7" fill="#78350F" font-family="Helvetica Neue, Arial, sans-serif">co-binning affinity</text>
<text x="910" y="342" text-anchor="middle" font-size="7" fill="#78350F" font-family="Helvetica Neue, Arial, sans-serif">consensus Leiden</text>
<text x="910" y="358" text-anchor="middle" font-size="8" font-weight="600" fill="#92400E" font-family="Helvetica Neue, Arial, sans-serif">→ Consensus Bins</text>

<!-- ══════════════════════════════════════════════════════════════════════════ -->
<!-- LEGEND -->
<!-- ══════════════════════════════════════════════════════════════════════════ -->
<rect x="20" y="394" width="14" height="14" rx="2" fill="url(#amber)" stroke="#D97706" stroke-width="1"/>
<text x="42" y="405" font-size="8" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">Novel aDNA-aware components</text>

<rect x="240" y="394" width="14" height="14" rx="2" fill="#F8FAFC" stroke="#CBD5E1" stroke-width="1"/>
<text x="262" y="405" font-size="8" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">Standard components</text>

<rect x="440" y="394" width="14" height="14" rx="2" fill="#FFFFFF" stroke="#94A3B8" stroke-width="1" stroke-dasharray="4,2"/>
<text x="462" y="405" font-size="8" fill="#64748B" font-family="Helvetica Neue, Arial, sans-serif">Parallel execution</text>

</svg>
